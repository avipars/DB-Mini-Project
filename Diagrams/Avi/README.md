Trying to simplify things and also make it so the DSD generates nicely

WIP